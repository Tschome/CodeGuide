### 是选择if else还是选择switch case呢

我在对代码进行优化时有遇见过这样的代码

```c
if(a == 1){
	b = 10;
}
else if( a == 2 || a== 3 || a== 4){
	b = 20;
}
```

觉得这段代码的执行效率属实在a=3或a=4时，需要执行判断好几次，执行效率不高，所以进行以下的代码优化：

```c
switch(a){
    case 1:
        b = 10;
        break;
    case 2:
    case 3:
    case 4:
        b = 20;
        break;
    default:
        //printf err
        return;
}
```

但是通过百度了解到，虽然说switch语句在分支很多的时候的效率很高，但是switch语句占用代码空间会大，因为它要生成跳表，以供随机访问，特别是当case常量分布范围很大但实际有效值又比较少的情况，switch语句的空间利用率会很低。

问题：

1. switch语句的效率是比if语句高，但是占用代码空间大，这个问题在有些层面时，比如在存储容量很小的设备里跑程序，是否需要考虑代码空间大小。

2. 在switch少量分支的情况下，效率还代码占用空间大小，switch和if更应该选择哪一个。



switch-case的效率略高于if-elseif结构，通过查阅资料得到下面一些结果。
switch-case与if-elseif的根本区别在于汇编时，switch-case会生成一个跳转表来指示实际的case分支的地址，而这个跳转表的索引号与switch变量的值是相等的。从而，switch-case不用像if-elseif那样遍历条件分支直到命中条件，而只需访问对应索引号的表项从而到达定位分支的目的。
具体地说，switch-case会生成一份表项数为case量＋1的跳表，程序首先判断switch变量是否大于（小于）最大（最小）case 常量，若大于（小于），则跳到default分支处理；否则取得索引号为switch变量大小的跳表项的地址（即跳表的起始地址＋表项大小＊索引号），程序接着跳到此地址执行，到此完成了分支的跳转。

由此看来，switch-case结构有一点以空间换时间的意思，当分支较多的时候明显switch-case结构的实行效率会高很多。但是switch-case的缺点是只能处理常量的匹配，在仅有常量选择分支的时候，可以选用switch-case结构，而此时通过遍历数组比较更是不可取的一种方式，但是if-elseif可以应用于更多的场合（如a > 10 && a < 20），显得更为灵活。

原文链接：https://blog.csdn.net/wyk19950704/article/details/50983903


